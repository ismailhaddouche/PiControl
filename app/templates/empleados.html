{% extends 'base.html' %}

{% block title %}Empleados{% endblock %}

{% block content %}
  <h2>Empleados</h2>
  <p><a href="/admin/empleados/archivados">Ver archivo de empleados</a></p>
  <div class="card">
    <table>
      <tr><th>DNI</th><th>Nombre</th><th>RFID</th><th>Acciones</th></tr>
      {% for e in empleados %}
      <tr>
        <td>{{ e.dni }}</td>
        <td>{{ e.nombre }}</td>
        <td id="rfid-cell-{{ e.dni }}">{{ e.rfid_uid or '' }}</td>
        <td>
          <!-- Fallback POST form (sin JS) -->
          <form method="post" action="/admin/empleados/{{ e.dni }}/assign" style="display:inline">
            <input name="rfid_uid" id="rfid-input-{{ e.dni }}" placeholder="rfid-xxx" />
            <button type="submit">Asignar</button>
          </form>
          <!-- Bot칩n AJAX (si JS est치 disponible) -->
          <button data-ajax-assign data-empid="{{ e.dni }}" class="secondary">Asignar (AJAX)</button>
          <!-- Bot칩n para archivar -->
          <form method="post" action="/admin/empleados/{{ e.dni }}/archive" style="display:inline; margin-left:8px">
            <button type="submit" class="danger">Archivar</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </table>
  </div>

  <h3>A침adir empleado</h3>
  <form method="post" action="/admin/empleados">
    <label>DNI: <input name="dni" required/></label>
    <label>Nombre: <input name="nombre" required/></label>
    <label>RFID (opcional): <input name="rfid_uid" /></label>
    <button type="submit">Crear</button>
  </form>
{% endblock %}
